<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Fotos ğŸ¤</title>
  <link rel="stylesheet" href="style.css">

  <style>
    .bloque {
      margin-bottom: 30px;
    }

    .bloque h2 {
      margin-bottom: 10px;
    }

    .galeria {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }

    .galeria img {
      width: 100%;
      border-radius: 8px;
    }
  </style>
</head>

<body>

  <div class="contenedor">
    <h1>Fotos ğŸ¤</h1>

    <div class="bloque">
      <h2>ğŸ“¸ Amigos</h2>
     <input type="file" accept="image/*" id="file-amigos" style="display:none">
    <button onclick="enviarFoto('amigos')">Enviar foto</button>
      <div class="galeria" id="galeria-amigos"></div>
    </div>

    <div class="bloque">
      <h2>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Familia</h2>
     <input type="file" accept="image/*" id="file-familia" style="display:none">
<button onclick="enviarFoto('familia')">Enviar foto</button>
      <div class="galeria" id="galeria-familia"></div>
    </div>

    <div class="bloque">
      <h2>âœ¨ Liz</h2>
      <input type="file" accept="image/*" id="file-liz" style="display:none">
<button onclick="enviarFoto('liz')">Enviar foto</button>
      <div class="galeria" id="galeria-ella"></div>
    </div>

    <div class="bloque">
      <h2>ğŸ¤ Nosotros</h2>
      <input type="file" accept="image/*" id="file-nosotros" style="display:none">
<button onclick="enviarFoto('nosotros')">Enviar foto</button>
      <div class="galeria" id="galeria-nosotros"></div>
    </div>

    <button onclick="window.location.href='index.html'">
      Volver
    </button>
  </div>

  <!-- Supabase -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

  <script>
    const supabaseUrl = "https://vunamqmjquqqbjcuewfp.supabase.co";
    const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ1bmFtcW1qcXVxcWJqY3Vld2ZwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgwNjAzMDksImV4cCI6MjA4MzYzNjMwOX0.Az5YzL_lMnaxjaR-o399mLeOctRincjK-SJGV9yHoOA";

    const supabase = window.supabase.createClient(
      supabaseUrl,
      supabaseKey
    );

        async function cargarFotos(categoria) {
      const { data } = await supabase.storage
        .from("fotos")
        .list(categoria);

      const contenedor = document.getElementById(`galeria-${categoria}`);
      contenedor.innerHTML = "";

      data.forEach(foto => {
        const url = supabase.storage
          .from("fotos")
          .getPublicUrl(`${categoria}/${foto.name}`).data.publicUrl;

        const img = document.createElement("img");
        img.src = url;
        contenedor.appendChild(img);
      });
    }

    ["amigos", "familia", "liz", "nosotros"].forEach(cargarFotos);
    
    function enviarFoto(categoria) {
  const input = document.getElementById(`file-${categoria}`);
  input.click();

  input.onchange = async () => {
    const file = input.files[0];
    if (!file) return;

    const nombre = `${Date.now()}-${file.name}`;

    const { error } = await supabase.storage
      .from("fotos")
      .upload(`${categoria}/${nombre}`, file);

    if (!error) {
      alert("Recuerdo subido, los cuidarÃ© con el corazÃ³n ğŸ¤");
      cargarFotos(categoria);
      input.value = "";
    } else {
      alert("No se pudo subir la foto ğŸ¤");
      console.error(error);
    }
  };
}
  </script>

</body>
</html>
