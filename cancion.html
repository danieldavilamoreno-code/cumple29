<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Lo que vive en m√≠ ü§ç</title>

  <!-- Estilos globales -->
  <link rel="stylesheet" href="style.css">

  <!-- Tipograf√≠as -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Montserrat:wght@300;400&display=swap" rel="stylesheet">

  <!-- Estilos SOLO de esta p√°gina -->
  <style>
    #mensajeDia {
      color: #7a4a6a;
      font-size: 14px;
      margin-bottom: 15px;
      display: block;
      animation: aparecer 1.5s ease;
    }

    #tipoDia {
      font-weight: 600;
      margin-bottom: 5px;
    }

    @keyframes aparecer {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
</head>

<body>

  <div class="contenedor">
    <h1>Para ti ü§ç</h1>

    <p id="tipoDia"></p>
    <p id="mensajeDia"></p>
    <p id="guiaDia"></p>

    <form onsubmit="enviarFormulario(event)">
      <input type="hidden" id="tipoHidden">

      <textarea
        id="textoRecuerdo"
        placeholder="Escribe aqu√≠ lo que quieras guardar‚Ä¶"
        required
      ></textarea>

      <button type="submit">Guardar</button>

      <button
        type="button"
        class="volver"
        onclick="window.location.href='index.html'"
      >
        Volver a la p√°gina principal
      </button>
    </form>
  </div>

  <!-- Supabase -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

  <script>
    /* üî¥ 1. CONFIGURA TUS CLAVES DE SUPABASE */
    const supabaseUrl = "https://vunamqmjquqqbjcuewfp.supabase.co";
    const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZ1bmFtcW1qcXVxcWJqY3Vld2ZwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgwNjAzMDksImV4cCI6MjA4MzYzNjMwOX0.Az5YzL_lMnaxjaR-o399mLeOctRincjK-SJGV9yHoOA";

    const supabase = window.supabase.createClient(
      supabaseUrl,
      supabaseKey
    );

    /* üîÆ L√ìGICA DEL D√çA */
    document.addEventListener("DOMContentLoaded", function () {
      const mensaje = document.getElementById("mensajeDia");
      const tipoTexto = document.getElementById("tipoDia");
      const tipoHidden = document.getElementById("tipoHidden");

      const inicio = new Date("2026-01-10");
      const hoy = new Date();
      const diff = Math.floor((hoy - inicio) / (1000 * 60 * 60 * 24));
      const dia = diff % 3;

      if (dia === 0) {
        tipoTexto.innerHTML = "üé∂ Hoy: una canci√≥n";
        mensaje.innerHTML = "Guarda una canci√≥n que te acompa√±e ü§ç";
        tipoHidden.value = "Canci√≥n";
      } else if (dia === 1) {
        tipoTexto.innerHTML = "ü§ç Hoy: una emoci√≥n";
        mensaje.innerHTML = "Ponle nombre a lo que sientes, sin juzgarlo.";
        tipoHidden.value = "Emoci√≥n";
      } else {
        tipoTexto.innerHTML = "üåô Hoy: un recuerdo";
        mensaje.innerHTML = "Conserva un recuerdo que te haga sonre√≠r.";
        tipoHidden.value = "Recuerdo";
      }
    });

    /* üíæ GUARDAR EN SUPABASE */
    async function enviarFormulario(e) {
      e.preventDefault();

      const texto = document.getElementById("textoRecuerdo").value.trim();
      const tipo = document.getElementById("tipoHidden").value;

      if (!texto) return;

      const { error } = await supabase
        .from("momentos")
        .insert([
          {
            tipo: tipo,
            contenido: texto,
            fecha: new Date().toISOString().split("T")[0],
            origen: "ella"
          }
        ]);

      if (!error) {
        alert("Guarda aqu√≠ los momentos que m√°s valoras‚Ä¶ prometo cuidarlos ü§ç");
        document.getElementById("textoRecuerdo").value = "";
      } else {
        alert("Algo fall√≥, pero no se perdi√≥ nada ü§ç");
        console.error(error);
      }
    }
  </script>

</body>
</html>
